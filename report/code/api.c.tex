\begin{Verbatim}[commandchars=\\\{\},codes={\catcode`\$=3\catcode`\^=7\catcode`\_=8\relax}]
\PY{c+cm}{/* acquires lock, spins until lock is available*/}
\PY{k+kt}{void}\PY{+w}{ }\PY{n+nf}{write\PYZus{}lock}\PY{p}{(}\PY{p}{)}\PY{p}{;}\PY{+w}{  }
\PY{c+cm}{/* if lock is not available returns false immediately*/}
\PY{k+kr}{inline}\PY{+w}{ }\PY{k+kt}{bool}\PY{+w}{ }\PY{n+nf}{try\PYZus{}write\PYZus{}lock}\PY{p}{(}\PY{p}{)}\PY{p}{;}
\PY{c+cm}{/* unlocks write\PYZus{}lock acquired by write\PYZus{}lock or try\PYZus{}write\PYZus{}lock */}
\PY{k+kt}{void}\PY{+w}{ }\PY{n+nf}{write\PYZus{}unlock}\PY{p}{(}\PY{p}{)}\PY{p}{;}\PY{+w}{ }


\PY{c+cm}{/* allows the reader and returns the current version number*/}\PY{+w}{ }
\PY{k+kt}{uint64\PYZus{}t}\PY{+w}{ }\PY{n+nf}{read\PYZus{}lock}\PY{p}{(}\PY{p}{)}\PY{p}{;}\PY{+w}{ }

\PY{c+cm}{/* returns VersionNumber upon success, spins until lock is }
\PY{c+cm}{ * available if writer is present*/}
\PY{k+kr}{inline}\PY{+w}{ }\PY{k+kt}{uint64\PYZus{}t}\PY{+w}{ }\PY{n+nf}{read\PYZus{}lock\PYZus{}wait}\PY{p}{(}\PY{p}{)}\PY{p}{;}\PY{+w}{ }

\PY{c+cm}{/* returns true if version number matches, application }
\PY{c+cm}{ * needs to retry if false is returned*/}
\PY{k+kr}{inline}\PY{+w}{ }\PY{k+kt}{bool}\PY{+w}{ }\PY{n+nf}{read\PYZus{}unlock}\PY{p}{(}\PY{k+kt}{uint64\PYZus{}t}\PY{+w}{ }\PY{n}{local\PYZus{}version\PYZus{}number}\PY{p}{)}\PY{p}{;}\PY{+w}{ }
\end{Verbatim}
